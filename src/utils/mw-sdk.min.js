(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b():'function'==typeof define&&define.amd?define([],b):'object'==typeof exports?exports.mwSdk=b():a.mwSdk=b()})('undefined'==typeof self?this:self,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)}([function(a,b,c){'use strict';function d(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var e='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(1),h=function(a){return a&&a.__esModule?a:{default:a}}(g),i=function(){function a(b){var c=b.wx,e=b.mlink,f=b.params,g=void 0===f?{}:f,h=b.callback,i=b.cparams,j=void 0===i?{}:i;d(this,a),this.isError({wx:c,mlink:e,params:g,callback:h,cparams:j})&&(console.log('\u53C2\u6570\u6B63\u5E38'),this.wx=c,this.mlink=e,this.params=g,this.callback=h,this.cparams=j,this.baseUrl='https://s.mlinks.cc/su/',this.getPath(),this.tracking())}return f(a,[{key:'tracking',value:function(){var a=new Date().getTime()+Math.floor(1e13*Math.random()),b=this,c='https://stats.mlinks.cc/tracking/i'+'?ch=xcx&action=mwi&cid='+this.mlink+'&rdm='+a;this.wx.request({url:c,method:'get'})}},{key:'getPath',value:function(){var a=this,b=this.url(this.mlink,this.params);this.wx.request({url:b,method:'POST',success:function(b){a.callbackData(b)},fail:function(){console.error('\u63A5\u53E3\u8C03\u7528\u5931\u8D25')}})}},{key:'callbackData',value:function(a){var b=a.data,c=this.isSystem();if(0==b.code)if('android'===c){if(b.result.androidLink){var d=b.result.androidLink;d=d+(-1===d.indexOf('?')?'?':'&')+this.passParamsToApp(b.result),this.callback({link:d})}else this.callback({link:''});}else if('ios'===c)if(b.result.iosLink){var e=b.result.iosLink;e=e+(-1===e.indexOf('?')?'?':'&')+this.passParamsToApp(b.result),this.callback({link:e})}else this.callback({link:''})}},{key:'isSystem',value:function(){var a=this.wx.getSystemInfoSync(),b=a.system;return b.includes('Android')?'android':b.includes('iOS')?'ios':null}},{key:'url',value:function(a,b){var c,d=this.objChangeQuery(b),e='';try{c=a.split('/'),e=c[c.length-1]}catch(a){console.error(a)}return d?''+this.baseUrl+e+d:''+this.baseUrl+e}},{key:'objChangeQuery',value:function(a){var b='';for(var c in a)b+=0==b.length?'?'+c+'='+a[c]:'&'+c+'='+a[c];return b}},{key:'isError',value:function(a){var b=a.wx,c=a.mlink,d=a.params,f=a.callback,g=a.cparams;return b?c?'string'==typeof c?'object'==('undefined'==typeof d?'undefined':e(d))?'function'==typeof f?'object'==('undefined'==typeof g?'undefined':e(g))||(console.error('cparams\u5FC5\u987B\u4E3A\u5BF9\u8C61'),!1):(console.error('callback\u5FC5\u987B\u4E3A\u51FD\u6570'),!1):(console.error('params\u5FC5\u987B\u4E3A\u5BF9\u8C61'),!1):(console.error('mlink\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32'),!1):(console.error('mlink\u5FC5\u4F20\u9012'),!1):(console.error('wx\u5FC5\u586B'),!1)}},{key:'getShorturlKey',value:function(){var a=new h.default(this.mlink),b=a.path.replace(/^\//,'');return b=b.replace('su/',''),b}},{key:'passParamsToApp',value:function(a){var b=[['mw_ck',encodeURIComponent('\u5C0F\u7A0B\u5E8F')].join('='),['mw_mk',encodeURIComponent(a.mLinkKey||'')].join('='),['mw_slk',encodeURIComponent(this.getShorturlKey()||'')].join('='),['mw_tags',encodeURIComponent(a.tags||'')].join('=')];for(var c in this.cparams)b.push(['mw_dynp_'+c,encodeURIComponent(this.cparams[c])].join('='));return b=b.join('&'),b}},{key:'openAppError',value:function(){console.log('app\u6253\u5F00\u5931\u8D25')}}]),a}();b.default=i,a.exports=b['default']},function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'';c(this,a);var d=b.match(/(\w+):\/\/([^:\/\?]*):?(\d*)([^\?]*)\??([^#$]*)#?([^#]*)/)||[];this.scheme=d[1]||'',this.protocol=d[1]||'',this.domain=d[2]||'',this.host=d[2]||'',this.port=d[3]||'',this.path=d[4]||'',this.queryString=d[5]||'',this.search=d[5]||'',this.hash=d[6]||''}return d(a,[{key:'getParams',value:function(){var a=this.queryString.split('&'),b={};return a.forEach(function(a){var c=a.split('=');c[0]&&(b[c[0]]=c[1])}),b}},{key:'getParam',value:function(a){return this.getParams()[a]}},{key:'setParam',value:function(a,b){var c=this.getParams(),d=[];for(var e in'undefined'==typeof b?delete c[a]:c[a]=b,c)d.push(e+'='+c[e]);return this.queryString=d.join('&'),this}},{key:'setParams',value:function(a){var b=this.getParams(),c=[];for(var d in a)null===b[d]?delete b[d]:b[d]=a[d];for(var e in b)c.push(e+'='+b[e]);return this.queryString=c.join('&'),this}},{key:'assignObj',value:function(a){var b=this.getParams();return Object.assign(b,a),b}},{key:'getStringUri',value:function(a){var b=this.assignObj(a);if(this.domain){var c=[];return c.push(this.scheme),c.push('://'),c.push(this.domain),Object.keys(b).forEach(function(a,d){0===d?c.push('?'+a+'='+b[a]):c.push('&'+a+'='+b[a])}),c.join('')}return''}},{key:'getStrParams',value:function(){var a=[];return Object.keys(_parsms).forEach(function(b,c){0===c?a.push('?'+b+'='+_parsms[b]):a.push('&'+b+'='+_parsms[b])}),a.join('')}}]),a}();b.default=e,a.exports=b['default']}])});